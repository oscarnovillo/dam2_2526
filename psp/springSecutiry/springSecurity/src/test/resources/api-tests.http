### ============================================
### API REST - Spring Security Tutorial
### ============================================
### Credenciales:
### - usuario:password123 → dXN1YXJpbzpwYXNzd29yZDEyMw==
### - admin:admin123 → YWRtaW46YWRtaW4xMjM=
### ============================================

### -----------------------------------------
### JWT AUTHENTICATION
### -----------------------------------------

### 1. Login - Obtener token JWT (usuario normal)
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  "username": "usuario",
  "password": "password123"
}

> {%
    client.global.set("userToken", response.body.token);
%}

###

### 2. Login - Obtener token JWT (admin)
POST http://localhost:8080/api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}

> {%
    client.global.set("adminToken", response.body.token);
%}

###

### 3. Usar token JWT - Endpoint privado
GET http://localhost:8080/api/private
Accept: application/json
Authorization: Bearer {{userToken}}

###

### 4. Usar token JWT - Endpoint admin
GET http://localhost:8080/api/admin
Accept: application/json
Authorization: Bearer {{adminToken}}

###

### 5. Token inválido → 401 Unauthorized
GET http://localhost:8080/api/private
Accept: application/json
Authorization: Bearer token_invalido_12345

###

### -----------------------------------------
### ENDPOINTS PÚBLICOS (sin autenticación)
### -----------------------------------------

### Endpoint público - No requiere login
GET http://localhost:8080/api/public
Accept: application/json

###

### -----------------------------------------
### ENDPOINTS PROTEGIDOS (Basic Auth)
### -----------------------------------------

### Endpoint privado - Usuario normal
GET http://localhost:8080/api/private
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### -----------------------------------------
### ENDPOINTS SOLO ADMIN (SecurityConfig)
### -----------------------------------------

### Endpoint admin - Configurado en SecurityConfig con hasRole
GET http://localhost:8080/api/admin
Accept: application/json
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### -----------------------------------------
### @Secured - Seguridad a nivel de método (simple)
### -----------------------------------------

### @Secured("ROLE_ADMIN") - Con admin → 200 OK
GET http://localhost:8080/api/secured-admin
Accept: application/json
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### @Secured("ROLE_ADMIN") - Con usuario normal → 403 Forbidden
GET http://localhost:8080/api/secured-admin
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### -----------------------------------------
### @PreAuthorize - Se evalúa ANTES del método (SpEL)
### -----------------------------------------

### @PreAuthorize("hasRole('ADMIN')") - Con admin → 200 OK
GET http://localhost:8080/api/preauthorize-admin
Accept: application/json
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### @PreAuthorize("hasRole('ADMIN') or hasRole('USER')") → 200 OK para ambos
GET http://localhost:8080/api/preauthorize-complex
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### @PreAuthorize con parámetros - Usuario accede a sus propios datos → 200 OK
GET http://localhost:8080/api/user/usuario
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### @PreAuthorize con parámetros - Usuario intenta acceder a datos de otro → 403 Forbidden
GET http://localhost:8080/api/user/admin
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### @PreAuthorize con parámetros - Admin puede acceder a cualquiera → 200 OK
GET http://localhost:8080/api/user/usuario
Accept: application/json
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### -----------------------------------------
### @PostAuthorize - Se evalúa DESPUÉS del método
### -----------------------------------------

### @PostAuthorize - Usuario "usuario" es owner del recurso → 200 OK
GET http://localhost:8080/api/postauthorize/123
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### @PostAuthorize - Admin puede ver cualquier recurso → 200 OK
GET http://localhost:8080/api/postauthorize/123
Accept: application/json
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### -----------------------------------------
### PRUEBAS DE ACCESO DENEGADO
### -----------------------------------------

### Sin credenciales → 401 Unauthorized
GET http://localhost:8080/api/private
Accept: application/json

###

### Usuario normal a endpoint admin → 403 Forbidden
GET http://localhost:8080/api/admin
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### -----------------------------------------
### OPCIÓN 4: ANOTACIONES PERSONALIZADAS
### -----------------------------------------

### @IsAdmin - Anotación personalizada (admin) → 200 OK
GET http://localhost:8080/api/custom-admin
Accept: application/json
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### @IsAdmin - Con usuario normal → 403 Forbidden
GET http://localhost:8080/api/custom-admin
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### @IsUser - Anotación personalizada (usuario) → 200 OK
GET http://localhost:8080/api/custom-user
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### @IsAdminOrSelf - Usuario accede a su propio perfil → 200 OK
GET http://localhost:8080/api/profile/usuario
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### @IsAdminOrSelf - Usuario intenta ver perfil de otro → 403 Forbidden
GET http://localhost:8080/api/profile/admin
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### @IsAdminOrSelf - Admin puede ver cualquier perfil → 200 OK
GET http://localhost:8080/api/profile/usuario
Accept: application/json
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### -----------------------------------------
### OPCIÓN 5: JSR-250 (Estándar Java EE)
### -----------------------------------------

### @RolesAllowed("ADMIN") - Con admin → 200 OK
GET http://localhost:8080/api/jsr250-admin
Accept: application/json
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

### @RolesAllowed("ADMIN") - Con usuario normal → 403 Forbidden
GET http://localhost:8080/api/jsr250-admin
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### @RolesAllowed({"ADMIN", "USER"}) - Ambos pueden acceder → 200 OK
GET http://localhost:8080/api/jsr250-multiple
Accept: application/json
Authorization: Basic dXN1YXJpbzpwYXNzd29yZDEyMw==

###

### @PermitAll - Sin autenticación → 200 OK
GET http://localhost:8080/api/jsr250-public
Accept: application/json

###

### @DenyAll - Siempre denegado, incluso admin → 403 Forbidden
GET http://localhost:8080/api/jsr250-denied
Accept: application/json
Authorization: Basic YWRtaW46YWRtaW4xMjM=

###

